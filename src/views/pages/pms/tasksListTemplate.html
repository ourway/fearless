<div>
    <input ng-if="tasks.length" type="text" class="form-control" placeholder="Filter Tasks" 
    ng-model="project.filterTaskName" />
    <div id="tasksDiv">
        <div ng-if="tasks.length" style="margin: 0px;" class="alert alert-info alert-dismissable">
           <button type="button" class="close" data-dismiss="alert" 
              aria-hidden="true">
              &times;
           </button>
           <span>This project has {{tasks.length}} tasks.</span>
        </div>
        <table class="table table-responsive table table-bordered table-striped table-hover refresh-container pull-down">
        <tr title="{{task.title}}" class="active" 
            ng-repeat="task in tasks | orderBy:'start' | filter:project.filterTaskName ">
            <td class="info">
                <div style="color:grey"><b>{{$index+1}}</b></div>
                <br/>
                <div ng-show="isMyTask(task)">
                    <a><em style="color:rgb(96, 139, 181);" class="glyphicon glyphicon-user"></em></a>
                </div>

            </td>
            <td ng-class="{'success':task.gauge=='ahead of schedule', 'warning':task.gauge=='on schedule', 'danger':task.gauge=='behind schedule'}">
                <em style="color:lightgrey" class="glyphicon glyphicon-list-alt"></em>
                <a class="taskA" ng-click="taskDetail(task.id)"  ng-class="{'farsi':!$parent.isASCII(task.title)}" 
                    style="font-size: 13px;" data-task-title="{{toTitleCase(task.title)}}" 
                    ng-mouseover="taskHoverIn()" ng-mouseleave="taskHoverOut()" 
                    id="task_{{task.id}}" >{{toTitleCase(task.title).slice(0,30)}}</a>


            <div class="progress" style="height:3px;margin-bottom: 0px;">
                <div class="progress-bar" role="progressbar" aria-valuenow="{{task.complete}}" 
                    aria-valuemin="0" aria-valuemax="100" style="width: {{task.complete}}%;">
                  <span class="sr-only">{{task.complete}}% Complete</span>
              </div>
            </div>

            <small style="color:grey" ng-repeat="person in task.resources track by $index">
                <a ng-show="person.id!=$parent.userInfo.userid" style="color:grey" href="#/user/{{person.id}}">{{person.lastname}}</a>
                <a ng-show="person.id==$parent.userInfo.userid" style="color:grey" href="#/user/{{person.id}}"><strong>You</strong></a>
                <small ng-if="$index!=task.resources.length-1">, </small>
            </small>
            <br/>
            <a class="taskDetailOptions glyphicon glyphicon-edit"
                 data-toggle="modal" data-target="#taskReviewModal"
                ng-click="taskDetail(task.id, true)"
                style="padding:3px;cursor:pointer;text-decoration:none;color:grey" ></a>
            </td>
            <td>
                        <div ng-show="task.effort==0">
                    <a><em style="color:#515151" class="glyphicon glyphicon-screenshot"></em></a>
                </div>
               <div ng-show="task.complete==100">
                    <em style="color:green" class="glyphicon glyphicon-ok"></em>
                </div>
                <div ng-show="task.dependent_of.length>0">
                    <em style="color:grey" class="glyphicon glyphicon-export"></em>
                </div>
                <div ng-show="task.depends.length>0">
                    <em style="color:grey" class="glyphicon glyphicon-import"></em>
                </div>
        </tr>
        </table>
    </div>
</div>



<div class="modal fade" id="taskReviewModal" ng-init=""
    role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">


				<div class="modal-dialog">
					<div class="modal-content">
						<div class="modal-header">
							 <button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button>
							<h4 class="modal-title" id="myModalLabel">
                                review: {{reviewTask.title}}
							</h4>
						</div>
                        <div class="modal-body">
                            <form class="form-horizontal" role="form">
                                <span 
                                    ng-class="{
                                    'text-warning':reviewTask.gauge=='behind schedule', 
                                    'text-info':reviewTask.gauge=='on schedule',
                                    'text-success':reviewTask.gauge=='ahead of schedule'
                                    }">
                                    <strong>{{reviewTask.gauge}}</strong></span>
                                <br/>
            <span ng-if="reviewTask.resources.length">
                <small style="color:grey">This task is alocated to</small>
                
                <small style="color:grey" ng-repeat="person in reviewTask.resources track by $index">
                    <a ng-show="person.id!=$parent.userInfo.userid" href="#/user/{{person.id}}">{{person.fullname}}</a>
                    <a ng-show="person.id==$parent.userInfo.userid" href="#/user/{{person.id}}"><strong>You</strong></a>
                    <small ng-if="$index!=reviewTask.resources.length-1">, </small>
                </small>
            </span>
            <span ng-if="!reviewTask.resources.length">
                <small style="color:grey">This task has not allocated to
                    <span class="text-danger">anyone</span></small>
</span>
            <small style="color:grey">and <strong>{{reviewTask.complete}}%</strong> completed.</small>
				<div class="form-group">
					<div class="col-lg-12">
                        <textarea class="form-control" 
                            ng-class="{'farsi':!$parent.isASCII(reviewTask.body)}"
                            placeholder="write your review about {{task.title}}" ng-model="reviewTask.body"></textarea>
					</div>
				</div>
			</form>
		</div>
						<div class="modal-footer">
                            <button type="button" ng-click="reviewTask.body=null" class="btn btn-default" data-dismiss="modal">Close</button> 
                            <button type="button" ng-show="reviewTask.body.length>10" 
                                ng-click="sendTaskReview()" class="btn btn-primary">Send your review</button>
						</div>
					</div>
					
				</div>
</div>
