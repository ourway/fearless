<style>

    #printable { display: none; }

    @media print
    {
    	#non-printable { display: none; }
    	#printable { display: block; }
    }


table {
border-collapse: 0px;
border-spacing: 0;
}
    table { page-break-inside:auto }
    tr    { page-break-inside:avoid; page-break-after:auto }
    thead { display:table-header-group }
    tfoot { display:table-footer-group }

.tj_table_frame {
line-height: 1;
margin-left: 0px;
margin-right: 0px;
text-align: center;
background-color: #9a9a9a;
margin-top: 15px;
margin-bottom: 15px;
box-shadow: 1px 1px 17px #000D1A;
border: 7px solid #E0E0E0;
border-radius: 2px;
border-spacing: 0px;
text-rendering: geometricPrecision;
text-shadow: 1px 1px 3px #ccc;
text-color: #fff;
}
.taskbarframe {
background-color: #000000;
position: absolute;
box-shadow: 0px 0px 28px #8FB4C7;
}

.offduty {
background-color: rgba(185, 206, 219, 1);
white-space: nowrap;
position: absolute;
}
.taskbar {
background-color: #36B0D5;
position: absolute;
}
.tabhead {
white-space: nowrap;
background-color: #E6E6E6;
color: #373737;
text-align: center;
}
.progressbar {
background-color: #510062;
position: absolute;
}
.tj_table_header_cell {
padding: 1px 5px 1px 3px;
white-space: nowrap;
border-spacing: 0px;
color: #000000;
overflow: hidden;
}
.free {
background-color: #D7FFA5;
position: absolute;
}

.tj_table {
background-color: rgba(54, 153, 213, 0.76);
margin: 0px;
border-spacing: 1px;
}
.busy {
background-color: #C399FF;
position: absolute;
}
.caltask1 {
background-color: #FFEDA5;
}

.pmsmaindiv{
    -webkit-font-smoothing: antialiased;
}

/*
.taskcell1{
border-right: 1px solid #57BEDD;
border-bottom: 1px solid #57BEDD;
}

.taskcell2{
border-right: 1px solid #57BEDD;
border-bottom: 1px solid #57BEDD;
}
.resourcecell1{
border-right: 1px solid #57BEDD;
border-bottom: 1px solid #57BEDD;

}
.resourcecell2{
border-right: 1px solid #57BEDD;
border-bottom: 1px solid #57BEDD;
}
.tabcell{
border-right: 1px solid #57BEDD;
border-bottom: 1px solid #57BEDD;
}
*/
</style>

<div class="container pmsmaindiv">
    <br/>
	<div class="row clearfix" ng-cloak>
			<ul class="breadcrumb">
				<li>
					<a href="#/pms">Projects</a> <span class="divider"></span>
				</li>
				<li class="active">
				    {{project.name}}
				</li>
			</ul>
    </div>
	<div class="row clearfix" ng-cloak>



			<div class="modal fade" id="projectEditModal" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
				<div class="modal-dialog">
					<div class="modal-content">
						<div class="modal-header">
							 <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
							<h4 class="modal-title" id="myModalLabel">
                                Edit project: {{project.name}}
							</h4>
						</div>
                        <div class="modal-body">

			<form class="form-horizontal" role="form">
				<div class="form-group">
					 <label for="inputEmail3" class="col-sm-4 control-label">Project Name</label>
					<div class="col-sm-6">
                        <input type="text" class="form-control" ng-class="{'farsi':!$parent.isASCII(project.name)}"  placeholder="New project name. Must be unique" 
                        ng-model="project.name" />
					</div>
				</div>
				<div class="form-group" ng-init="newProject.start=timeConverter()">
					 <label for="inputEmail3" class="col-sm-4 control-label">Start Date</label>
					<div class="col-sm-6">
                        <input type="date" class="form-control" ng-model="project.start" required/>
					</div>
				</div>
				<div class="form-group">
					 <label for="inputPassword3" class="col-sm-4 control-label">End Date</label>
					<div class="col-sm-6">
						<input type="date" class="form-control" ng-model="project.end" required />
					</div>
				</div>

				<div class="form-group">
					 <label for="inputPassword3" class="col-sm-4 control-label">Leader</label>
					<div class="col-sm-6">
                        <select class="form-control" ng-model="project.leader" placeholder="Who's running the project?" 
                            ng-options="resource.fullname for resource in resources track by resource.id">
                        </select>
                </div>
                </div>

				<div class="form-group">
					 <label for="inputPassword3" class="col-sm-4 control-label">Watchers</label>
					<div class="col-sm-6">
                        <select class="form-control" ng-model="project.watchers" multiple 
                            ng-options="resource.fullname for resource in resources track by resource.id">
                            <option value="0"></option>
                        </select>
                </div>

            </div>
				<div class="form-group">
					 <label for="inputPassword3" class="col-sm-4 control-label">Description</label>
					<div class="col-sm-6">
                        <textarea placeholder="Write a brief description about project goal here ..." class="form-control" ng-model="project.description" ></textarea>
					</div>
				</div>

			</form>
						</div>
						<div class="modal-footer">
                            <button type="button" ng-click="getProjectDetails()" class="btn btn-default" data-dismiss="modal">Close</button> 
                            <button type="button" ng-show="project.name && project.start && project.end && project.leader.id" 
                                ng-click="updateProject()" class="btn btn-primary">Update project information</button>
						</div>
					</div>
					
				</div>
				
	</div>











			<div class="modal fade" id="taskSeqModal" role="dialog" ng-init="" aria-labelledby="AddNewSequences" aria-hidden="true">
				<div class="modal-dialog">
					<div class="modal-content">
						<div class="modal-header">
							 <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
							<h4 class="modal-title" id="myModalLabel">
								Append new sequences
							</h4>
						</div>
                        <div class="modal-body">

			<form class="form-horizontal" role="form">
				<div class="form-group">
					 <label for="inputEmail3" class="col-sm-4 control-label">Number of new sequences</label>
					<div class="col-sm-6">
                        <input type="number" class="form-control" placeholder="Enter number of new sequences" ng-model="newSequences.number" />
					</div>
				</div>
				<div class="form-group">
					 <label for="inputPassword3" class="col-sm-4 control-label">Sequence Lead</label>
					<div class="col-sm-6">
                        <select class="form-control" ng-model="newSequences.lead" 
                            ng-options="resource.fullname for resource in resources track by resource.id">
                        </select>
                     </div>
                 </div>

			</form>
						</div>
						<div class="modal-footer">
                            <button type="button" class="btn btn-default" ng-click="resetNewSequnences()" data-dismiss="modal">Close</button>
                            <button type="button" ng-disabled="!newSequences.number || newSequences.number<1 || !newSequences.lead"
                                ng-click="createNewSeq()" class="btn btn-success">Create new Sequences</button>
						</div>
					</div>

				</div>

			</div>







			<div class="modal fade" id="taskAddModal" role="dialog" ng-init="getTasksList()" aria-labelledby="myModalLabel" aria-hidden="true">
				<div class="modal-dialog">
					<div class="modal-content">
						<div class="modal-header">
							 <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
							<h4 class="modal-title" id="myModalLabel">
								Create a new task
							</h4>
						</div>
                        <div class="modal-body">

			<form class="form-horizontal" role="form">
				<div class="form-group">
					 <label for="inputEmail3" class="col-sm-4 control-label">Task title</label>
					<div class="col-sm-6">
                        <input type="text" class="form-control" ng-class="{'farsi':!$parent.isASCII(newtask.title)}"  placeholder="New task name" ng-model="newtask.title" />
					</div>
				</div>
				<div class="form-group">
					 <label for="inputEmail3" class="col-sm-4 control-label">Make task a milestone</label>
					<div class="col-sm-6">
                        <input type="checkbox" class="form-control" placeholder="New task name" ng-model="newtask.isMilestone" />
					</div>
				</div>
				<div class="form-group" ng-show="!newtask.isMilestone" >
					 <label for="inputEmail3" class="col-sm-4 control-label">Start</label>
					<div class="col-sm-6">
                        <input type="date" class="form-control" placeholder="Task start date" ng-model="newtask.start" />
					</div>
				</div>
				<div class="form-group" ng-show="newtask.isMilestone">
					 <label for="inputEmail3" class="col-sm-4 control-label">Delivery</label>
					<div class="col-sm-6">
                        <input type="date" class="form-control" placeholder="Task End date" ng-model="newtask.end" />
					</div>
				</div>
				<div class="form-group" ng-show="!newtask.isMilestone">
					 <label for="inputEmail3" class="col-sm-4 control-label">Effort</label>
					<div class="col-sm-6">
                        <input type="number" min="0" max="96" class="form-control" placeholder="How many hours?" ng-model="newtask.effort" required/>
					</div>
				</div>

				<div class="form-group">
					 <label for="inputPassword3" class="col-sm-4 control-label">Task Manager</label>
					<div class="col-sm-6">
                        <select class="form-control" ng-model="newtask.manager" 
                            ng-options="resource.fullname for resource in resources track by resource.id">
                        </select>
                     </div>
                 </div>



				<div class="form-group" ng-show="!newtask.isMilestone">
					 <label for="inputPassword3" class="col-sm-4 control-label">Resources</label>
					<div class="col-sm-6">
                        <select class="form-control" ng-model="newtask.resources" multiple 
                            ng-options="resource.fullname for resource in resources track by resource.id">
                        </select>
                     </div>
                </div>

				<div class="form-group">
					 <label for="inputEmail3" class="col-sm-4 control-label">Task Priority</label>
					<div class="col-sm-6">
                        <input type="number" min="1" max="1000" class="form-control" placeholder="How many hours?" ng-init="newTaskEffort=0" ng-model="newtask.priority" required/>
					</div>
				</div>



				<div class="form-group">
					 <label for="inputPassword3" class="col-sm-4 control-label">Depends On</label>
					<div class="col-sm-6">
                        <select class="form-control" ng-model="newtask.depends" multiple 
                            ng-options="task.title for task in tasks track by task.id">
                            <option value="0"></option>
                        </select>
                     </div>
                </div>

			</form>


						</div>
						<div class="modal-footer">
                            <button type="button" class="btn btn-default" ng-click="resetNewtask()" data-dismiss="modal">Close</button>
                            <button type="button" ng-disabled="!newtask.title || !newtask.manager"
                                ng-click="createNewTask()" class="btn btn-success">Create new task</button>
						</div>
					</div>

				</div>

			</div>







			<div class="modal fade" id="taskDetailModal" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
				<div class="modal-dialog">
					<div class="modal-content">
						<div class="modal-header">
							<h4 class="modal-title" id="myModalLabel">
								Task edit area
							</h4>
						</div>
                        <div class="modal-body">

			<form class="form-horizontal" role="form">
				<div class="form-group">
					 <label for="inputEmail3" class="col-sm-4 control-label">Task title</label>
					<div class="col-sm-6">
                        <input type="text" class="form-control" ng-class="{'farsi':!$parent.isASCII(editTaskInfo.title)}"  placeholder="Task name" 
                        ng-model="editTaskInfo.title" />
					</div>
				</div>
				<div class="form-group">
					 <label for="inputEmail3" class="col-sm-4 control-label">Start</label>
					<div class="col-sm-6">
                        <input type="date" class="form-control" placeholder="Task start date" ng-model="editTaskInfo.start"/>
					</div>
				</div>
				<div class="form-group" ng-show="editTaskInfo.effort==0">
					 <label for="inputEmail3"  class="col-sm-4 control-label">end</label>
					<div class="col-sm-6">
                        <input type="date" class="form-control" placeholder="Task end date" ng-model="editTaskInfo.end" />
					</div>
                </div>

				<div class="form-group">
					 <label for="inputEmail3" class="col-sm-4 control-label">Effort</label>
					<div class="col-sm-6">
                        <input type="number" min="0" max="96" class="form-control" placeholder="Task effort" ng-model="editTaskInfo.effort" />
					</div>
                </div>
				<div class="form-group">
					 <label for="inputEmail3" class="col-sm-4 control-label">Priority</label>
					<div class="col-sm-6">
                        <input type="number" min="1" max="1000" class="form-control" placeholder="Task effort" ng-model="editTaskInfo.priority" />
					</div>
                </div>

				<div class="form-group" >
					 <label for="inputPassword3" class="col-sm-4 control-label">Resources</label>
					<div class="col-sm-6">
                        <select class="form-control" ng-model="editTaskInfo.resources" multiple 
                            ng-options="resource.fullname for resource in resources track by resource.id">
                            <option value="0"></option>
                        </select>
                     </div>
                </div>
				<div class="form-group">
					 <label for="inputPassword3" class="col-sm-4 control-label">Depends On</label>
					<div class="col-sm-6">
                        <select class="form-control" ng-model="editTaskInfo.depends" multiple 
                            ng-options="task.title for task in can_depend track by task.id">
                            <option value="0"></option>
                        </select>
                     </div>
                </div>

            	<div ng-show="editTaskInfo.effort" class="form-group">
					 <label for="inputEmail3" class="col-sm-4 control-label">Complete</label>
					<div class="col-sm-6">
                        <div class="input-group-addon">{{editTaskInfo.complete}}</div>
                        <input type="range" class="form-control" min="0" max="100" placeholder="Task effort" ng-model="editTaskInfo.complete" />
					</div>
                </div>


			</form>


						</div>
						<div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                            <button type="button" ng-click="deleteTask(editTaskInfo.id)" class="btn btn-danger" >Delete Task</button>
                            <button type="button" ng-show="editTaskInfo.resources || editTaskInfo.effort==0"
                                ng-click="updateTask(editTaskInfo.id)" class="btn btn-primary">Update task</button>
						</div>
					</div>

				</div>

			</div>








    <div class="row clearfix" id="projectSummery">
        <button id="editProjectButton" ng-click="updateProjectModalPrepare()" class="btn btn-default btn-sm" type="button"><em class="glyphicon glyphicon-pencil"></em> Edit</button>

    <div class="row clearfix">
        <div class="col-md-3 column" id="projectDescription">
            <p>
            <em>{{project.description || 'Project has no description'}}</em>
            </p>
		</div>
		<div class="col-md-6 column">
            <br/>
                        <h4>Project Details</h4>
            <table class="table table-bordered table-responsive">
            <tr class="active">
                <td >Name</td>
                <td >Progress</td>
                <td >Start</td>
                <td >End</td>
                <td >Effort Left</td>
                <td >Project Leader</td>
            </tr>
            <tr class="success">
                <td class="active"><strong>{{project.name}}</strong></td>
                <td ><strong>{{project.complete}}</strong>%</td>
                <td class="farsi" >{{$parent.persianDate(project.start)}}</td>
                <td class="farsi" >{{$parent.persianDate(project.end)}}</td>
                <td >{{project.effort_left}}</td>
                <td ><a href="#/user/{{project.leader.id}}">{{project.leader.fullname}}</a></td>
            </tr>
        </table>
            <div ng-if="project.watchers">
            This project is under supervision of 
            <span ng-repeat="watcher in project.watchers track by $index">
                <a href="#user/{{watcher.id}}">{{watcher.firstname}} {{watcher.lastname}}</a>
                <em ng-show="$index+2 != project.watchers.length && $index+1 != project.watchers.length">,</em>
                <em ng-show="$index+2 == project.watchers.length">and</em>
            </span>
            </div>
		</div>

        <div class="col-md-3 column">
             <div id="canvasDiv" >
                <canvas style="padding:10px;" id="progressChart" width="96" height="96"></canvas>		
            </div>
		</div>
    </div>
    </div>

    <hr/>

    <div class="row clearfix" id="AssetsAndSequencesOfProject">



        <div class="col-md-9 column">
                        <h4>Project Assets</h4>
                        <div id="CollectionsDiv" >
                            <a class="projectCollectionsA" href="#/ams/c/{{collection.id}}?page=1" ng-repeat="collection in project.collections track by $index" 

                                title="{{collection.name}}">{{collection.name}}</a>
                        </div>
                    <hr/>
                        <h4 style="display:inline">Sequences</h4>
                            <button id="taskSeqButton" class="btn btn-default btn-sm" type="button"><em class="glyphicon glyphicon-plus"></em> Add SEQUENCES</button>
                        <div id="SequencesDiv" >
                            <a class="projectSeqA" href="#pms/{{project.id}}/seq/{{seq.number}}" ng-repeat="seq in project.sequences track by $index" title="{{req.code}}">{{seq.number}}</a>
                        </div>
                    </div>


                </div>

    <hr/>
            <h3>Project Management</h3>
    </div>
            <div class="row clearfix" id="ManagementDivProject">
		<div class="col-md-12 column">
			<div class="btn-group">
                <button id="taskAddButton" class="btn btn-default" type="button"><em class="glyphicon glyphicon-plus"></em> Add TASK</button>
                <button class="btn btn-default" ng-class="{'active':mode=='cal', 'btn-success':mode=='cal'}" 
                        ng-class="{'active':mode=='cal'}" ng-click="showCal();prepareCal();" type="button"><em class="glyphicon glyphicon-calendar"></em> Calendar</button>
                <button class="btn btn-default" ng-class="{'active':mode=='plan', 'btn-success':mode=='plan'}" 
                        ng-class="{'active':mode=='plan'}" ng-click="generateReport('plan')" type="button"><em class="glyphicon glyphicon-eye-open"></em> Plan</button>
                    <button class="btn btn-default" ng-class="{'active':mode=='guntt', 'btn-success':mode=='guntt'}" 
                        ng-click="generateReport('guntt')" type="button"><em class="glyphicon glyphicon-tasks"></em> Gantt</button>
                    <button class="btn btn-default" ng-class="{'active':mode=='resource', 'btn-success':mode=='resource'}"
                        ng-click="generateReport('resource')" type="button"><em class="glyphicon glyphicon-list-alt"></em> Resources</button>
                    <button class="btn btn-default" ng-class="{'active':mode=='profitAndLoss', 'btn-success':mode=='profitAndLoss'}" 
                        ng-click="generateReport('profitAndLoss')" type="button"><em class="glyphicon glyphicon-adjust"></em> Budget</button>
                <button class="btn btn-default" ng-click="print()" type="button"><em class="glyphicon glyphicon-print"></em> </button>
                <button ng-show="mode!='cal'" class="btn btn-default" ng-click="replan=true;generateReport(mode)" type="button"><em class="glyphicon glyphicon-repeat"></em> </button>
			</div>
			</div>
                <div class="col-md-3 column">
                    <br/>

                        <input ng-if="tasks" type="text" class="form-control" placeholder="Filter Tasks" ng-model="filterTaskName" />
                    <br/>
                    <div id="tasksDiv">
                        <ol class="">
                            <li ng-click="taskDetail(task.id)" title="{{task.name}}" class="taskA" 
                            ng-repeat="task in tasks | orderBy:'start' | filter:filterTaskName ">
                            
                            <a class="btn-sm" ng-class="{'farsi':!$parent.isASCII(task.title)}" style="color: #13560C;" data-task-title="{{toTitleCase(task.title)}}" 
                                ng-mouseover="taskHoverIn()" ng-mouseleave="taskHoverOut()" id="task_{{task.id}}" >{{toTitleCase(task.title).slice(0,30)}}</a></li>
                        </ol>

                    </div>
				</div>
				<div class="col-md-9 column">
                    <div id="projectDetailContainer">
                        <div id="projectDetailDiv"></div>
                    </div>
            </div>
            </div>

            <div class="row clearfix">
				<div class="col-md-3 column">
                </div>
				<div class="col-md-6 column">
                </div>
                <div class="col-md-3 column">
                </div>
            </div>


</div>


<script>
    $(document).ready(function(){
        $('#taskAddButton').click(function(){
            $('#taskAddModal').modal('show');
        });
        $('#taskSeqButton').click(function(){
            $('#taskSeqModal').modal('show');
        });
        $('#editProjectButton').click(function(){
            $('#projectEditModal').modal('show');
        });




    });
</script>


